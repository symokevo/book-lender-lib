<div class="container mt-4">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h1 class="fw-bold"><%= @book.title %></h1>
    <%= link_to "Edit", edit_book_path(@book), class: "btn btn-warning px-4" %>
  </div>

  <div class="card shadow-sm mb-4">
    <div class="card-body">
      <p><strong>Author:</strong> <%= @book.author %></p>
      <p><strong>Published Year:</strong> <%= @book.published_year %></p>
      <p>
        <strong>Status:</strong>
        <span class="badge <%= @book.status == 'available' ? 'bg-success' : 'bg-danger' %>">
          <%= @book.status.capitalize %>
        </span>
      </p>

      <% if @book.status == "available" %>
        <%= form_with url: borrow_book_path(@book), method: :patch, class: "d-inline" do %>
          <div class="input-group">
            <input type="text" name="borrower_name" class="form-control" placeholder="Borrower's Name" required>
            <button type="submit" class="btn btn-primary">Borrow</button>
          </div>
        <% end %>
      <% else %>
        <%= link_to "Return Book", return_book_path(@book), method: :patch, class: "btn btn-secondary" %>
      <% end %>
    </div>
  </div>

  <h3>Borrowing History</h3>
  <div class="table-responsive">
    <table class="table table-bordered">
      <thead class="table-light">
        <tr>
          <th>Borrower</th>
          <th>Borrowed At</th>
          <th>Returned At</th>
        </tr>
      </thead>
      <tbody>
        <% @borrowings.each do |borrowing| %>
          <tr>
            <td><%= borrowing.borrower_name %></td>
            <td><%= borrowing.borrowed_at.strftime("%B %d, %Y %I:%M %p") %></td>
            <td>
              <% if borrowing.returned_at %>
                <%= borrowing.returned_at.strftime("%B %d, %Y %I:%M %p") %>
              <% else %>
                <span class="text-danger">Not Returned</span>
              <% end %>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>
</div>
